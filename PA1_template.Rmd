---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
 
 
---
#### Author: Pradeep K. Pant, ppant@cpan.org
```{r echo=TRUE} 
# Loading and preprocessing the data
# Load CRAN modules 
library(downloader)
library(plyr)
library(knitr)
library(datasets)
library(ggplot2)

# Step 1: Download the activity data set if not avaliable in default location
Url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
# Check if zip has already been downloaded in projectData directory?
if(!file.exists("activity.zip")){
  download.file(Url,destfile="activity.zip",mode = "wb")
  }
# Check if zip has already been unzipped?
if(!file.exists("activity.csv")){
  unzip(zipfile="activity.zip")
}

# Read the .CSV file in R data structure 
activityData <- read.csv("activity.csv")
# Remove the NA values and store in a separate structure for future use
activityDataCleaned <- activityData[complete.cases(activityData),]
```
## What is mean total number of steps taken per day?
```{r}
# Calculate the total number of steps taken per day
steps_taken_per_day <- aggregate(steps ~ date, activityDataCleaned, sum)
```
**1. Create a histogram of no of steps taken per day**
```{r}
# Just for beautification
colors = c("red", "yellow", "green", "violet", "orange", "blue", "pink", "cyan") 
hist(steps_taken_per_day$steps, col=colors, main = "Histogram of total number of steps taken per day", xlab = "Steps taken per day")
```

**2. Calculate the mean and median of the total number of steps taken per day**
```{r}
# disabling scientific notation in R
options(scipen = 999)
# calculate mean and median values
steps_taken_per_day_mean <- round(mean(steps_taken_per_day$steps))
steps_taken_per_day_median <- median(steps_taken_per_day$steps)
```
* Mean is **`r steps_taken_per_day_mean`**
* Median is **`r steps_taken_per_day_median`**


## What is the average daily activity pattern?
```{r}
# Calculate average steps per interval for all days 
avg_steps_per_interval <- aggregate(steps ~ interval, activityDataCleaned , mean)

```

**1. Time series plot of the average number of steps taken?**

```{r}
plot(avg_steps_per_interval$interval, avg_steps_per_interval$steps, type='l', col=1, main="Average number of steps by Interval", xlab="Time Intervals", ylab="Average number of steps")
```

**The 5-minute interval that, on average, contains the maximum number of steps?**
```{r}
# Identify the interval index which has the highest average steps
interval_idx <- which.max(avg_steps_per_interval$steps)
# Identify the specific interval and the average steps for that interval
interval_on_max_steps<-avg_steps_per_interval[interval_idx, ]$interval
maxStepsOnInterval<-round(avg_steps_per_interval[interval_idx, ]$steps, digits = 1)
# Print max avg interval and max steps
```
* Interval in which max steps taken **`r interval_on_max_steps`**
* Max steps taken **`r maxStepsOnInterval`**

## Imputing missing values
## Are there differences in activity patterns between weekdays and weekends?
